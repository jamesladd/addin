<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>InboxAgent</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>

    <!-- Taskpane CSS -->
    <link rel="stylesheet" type="text/css" href="taskpane.css">
</head>
<body>
<div class="container">
    <header>
        <h1>ðŸ“¬ InboxAgent</h1>
        <p class="subtitle">Email Tracking & Event Monitor</p>
    </header>

    <section class="pin-reminder" id="pin-reminder" style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); border: 2px solid #ff6f00; animation: pulse 2s infinite;">
        <h2 style="color: #333;">ðŸ“Œ Important: Pin This Taskpane</h2>
        <p style="color: #333; font-size: 14px; margin-bottom: 10px;">
            To keep InboxAgent visible when composing or reading emails, please click the ðŸ“Œ pin icon in the top-right corner of this pane.
        </p>
        <button id="got-it-pin" class="btn btn-primary" style="background: #333;">Got it! I'll pin it now</button>
    </section>

    <section class="user-section">
        <h2>ðŸ‘¤ Current User</h2>
        <div class="status-card">
            <div class="status-item">
                <span class="status-label">Display Name:</span>
                <span id="user-display-name" class="status-value">Loading...</span>
            </div>
            <div class="status-item">
                <span class="status-label">Email:</span>
                <span id="user-email" class="status-value">Loading...</span>
            </div>
            <div class="status-item">
                <span class="status-label">Account Type:</span>
                <span id="user-account-type" class="status-value">Loading...</span>
            </div>
            <div class="status-item">
                <span class="status-label">Time Zone:</span>
                <span id="user-timezone" class="status-value">Loading...</span>
            </div>
        </div>
    </section>

    <section class="status-section">
        <h2>Status</h2>
        <div class="status-card">
            <div class="status-item">
                <span class="status-label">Deep Monitoring:</span>
                <span id="monitoring-status" class="status-value active">Active</span>
            </div>
            <div class="status-item">
                <span class="status-label">Event Runtime:</span>
                <span id="runtime-status" class="status-value">Checking...</span>
            </div>
            <div class="status-item">
                <span class="status-label">Current Item:</span>
                <span id="current-item" class="status-value">Loading...</span>
            </div>
            <div class="status-item">
                <span class="status-label">Events Tracked:</span>
                <span id="events-tracked" class="status-value">0</span>
            </div>
        </div>
    </section>

    <section class="monitoring-section">
        <h2>Recent Activities</h2>
        <div id="activity-log" class="activity-log">
            <div class="activity-item info">
                <div class="activity-time">Just now</div>
                <div class="activity-message">InboxAgent initialized</div>
            </div>
        </div>
    </section>

    <section class="actions-section">
        <h2>Actions</h2>
        <button id="toggle-monitoring" class="btn btn-warning">Pause Monitoring</button>
        <button id="clear-log" class="btn btn-secondary">Clear Log</button>
        <button id="trigger-test-event" class="btn btn-primary">Trigger Test Event</button>
        <button id="show-all-mailboxes" class="btn btn-success">ðŸ“Š View Mailbox Activity</button>
    </section>

    <section class="info-section">
        <h2>Tracked Events</h2>
        <ul class="info-list">
            <li>âœ“ New Message Compose</li>
            <li>âœ“ Attachments Changed</li>
            <li>âœ“ Recipients Changed</li>
            <li>âœ“ Message Send</li>
            <li>âœ“ From Address Changed</li>
            <li>âœ“ Sensitivity Label Changed</li>
            <li>âœ“ Category Changes</li>
            <li>âœ“ Flag Status Changes</li>
            <li>âœ“ Read/Unread Status</li>
            <li>âœ“ Reply/Forward Actions</li>
            <li>âœ“ Junk/Not Junk Marking</li>
            <li>âœ“ Email Moved/Deleted</li>
        </ul>
    </section>
</div>

<script type="text/javascript" src="queue.js"></script>

<!-- IIFE to log taskpane loading immediately -->
<script type="text/javascript">
  (function() {
    console.log('=== TASKPANE.HTML LOADING (IIFE) ===');
    console.log('Timestamp:', new Date().toISOString());
    console.log('Document ready state:', document.readyState);
    console.log('Office object available:', typeof Office !== 'undefined');
  })();
</script>

<script type="text/javascript" src="taskpane.js"></script>

<script type="text/javascript">
  (function() {
    console.log('=== TASKPANE.HTML FULLY LOADED (IIFE) ===');
    console.log('Timestamp:', new Date().toISOString());
  })();
</script>
</body>
</html>